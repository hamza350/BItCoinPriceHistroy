<h1>Prices</h1>
<label for="time">Choose a time period:</label>
<div>
  <select name="time" id="time" style="text-align:center;">
    <option value="year">1 year</option>
    <option value="month">1 months</option>
    <option value="week">1 week</option>
    <option value="hour">1 hour</option>
  </select> 
</div>
<div id="graph-container" width="960" height="200">
  <canvas id="myChart" width="960" height="200"></canvas>
</div>


<script>
  let y_array= [60000,50000,45000,55000,25000, 35000, 30000, 40000, 20000,15000,30000,5000];
  let m_array= [60000,50000,45000,5000];
  let w_array= [60000,50000,45000,55000,25000,30000,5000]
  let h_array= [60000,50000,45000,55000,25000, 35000,30000,5000]
  debugger
  var ctx = document.getElementById('myChart');
  document.querySelector('#time').addEventListener('change',function(){
      if(this.value == "year"){
        resetCanvas();
        var myChart = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: ['Jan', 'Feb', 'March', 'April', 'May', 'June', 'July', 'August', 'Sep', 'Oct', 'Nov', 'Dec'],
            datasets: [{
              label: 'Bitcoin Price',
              data: shuffleArray(y_array),
              backgroundColor: ['rgba(255, 99, 132, 0.2)', 'rgba(54, 162, 235, 0.2)', 'rgba(255, 206, 86, 0.2)', 'rgba(75, 192, 192, 0.2)', 'rgba(153, 102, 255, 0.2)', 'rgba(255, 159, 64, 0.2)', 'rgba(255, 159, 64, 0.2)','rgba(255, 99, 132, 0.2)','rgba(153, 102, 255, 0.2)', 'rgba(255, 159, 64, 0.2)' ],
              borderColor: ['rgba(255, 99, 132, 1)', 'rgba(54, 162, 235, 1)', 'rgba(255, 206, 86, 1)', 'rgba(75, 192, 192, 1)', 'rgba(153, 102, 255, 1)', 'rgba(255, 159, 64, 1)', 'rgba(255, 159, 64, 1)', 'rgba(255, 159, 64, 1)'],
              borderWidth: 1
            },
          ]
          },
          options: {
            scales: {
              yAxes: [{
                ticks: {
                  beginAtZero: true
                }
              }]
            }
          }
        });
      }else if(this.value == "month"){
        resetCanvas();
        var myChartMonthly = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: ['1 week', '2 week', '3 week', '4 week'],
            datasets: [{
              label: 'Bitcoin Price',
              data: shuffleArray(m_array),
              backgroundColor: ['rgba(255, 99, 132, 0.2)', 'rgba(54, 162, 235, 0.2)', 'rgba(255, 206, 86, 0.2)', 'rgba(75, 192, 192, 0.2)', 'rgba(153, 102, 255, 0.2)', 'rgba(255, 159, 64, 0.2)', 'rgba(255, 159, 64, 0.2)','rgba(255, 99, 132, 0.2)','rgba(153, 102, 255, 0.2)', 'rgba(255, 159, 64, 0.2)' ],
              borderColor: ['rgba(255, 99, 132, 1)', 'rgba(54, 162, 235, 1)', 'rgba(255, 206, 86, 1)', 'rgba(75, 192, 192, 1)', 'rgba(153, 102, 255, 1)', 'rgba(255, 159, 64, 1)', 'rgba(255, 159, 64, 1)', 'rgba(255, 159, 64, 1)'],
              borderWidth: 1
            },
          ]
          },
          options: {
            scales: {
              yAxes: [{
                ticks: {
                  beginAtZero: true
                }
              }]
            }
          }
        });

      }else if(this.value == "week"){
        resetCanvas()
        var myChartWeekly = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'],
            datasets: [{
              label: 'Bitcoin Price',
              data: shuffleArray(w_array),
              backgroundColor: ['rgba(255, 99, 132, 0.2)', 'rgba(54, 162, 235, 0.2)', 'rgba(255, 206, 86, 0.2)', 'rgba(75, 192, 192, 0.2)', 'rgba(153, 102, 255, 0.2)', 'rgba(255, 159, 64, 0.2)', 'rgba(255, 159, 64, 0.2)','rgba(255, 99, 132, 0.2)','rgba(153, 102, 255, 0.2)', 'rgba(255, 159, 64, 0.2)' ],
              borderColor: ['rgba(255, 99, 132, 1)', 'rgba(54, 162, 235, 1)', 'rgba(255, 206, 86, 1)', 'rgba(75, 192, 192, 1)', 'rgba(153, 102, 255, 1)', 'rgba(255, 159, 64, 1)', 'rgba(255, 159, 64, 1)', 'rgba(255, 159, 64, 1)'],
              borderWidth: 1
            },
          ]
          },
          options: {
            scales: {
              yAxes: [{
                ticks: {
                  beginAtZero: true
                }
              }]
            }
          }
        });      
      }else{
        resetCanvas()
        var myChartDaily = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: ['12:00-3:00', '3:00-6:00', '6:00-9:00', '9:00-12:00', '12:00-15:00', '15:00-18:00', '18:00-21:00','21:00-24:00'],
            datasets: [{
              label: 'Bitcoin Price',
              data: shuffleArray(h_array) ,
              backgroundColor: ['rgba(255, 99, 132, 0.2)', 'rgba(54, 162, 235, 0.2)', 'rgba(255, 206, 86, 0.2)', 'rgba(75, 192, 192, 0.2)', 'rgba(153, 102, 255, 0.2)', 'rgba(255, 159, 64, 0.2)', 'rgba(255, 159, 64, 0.2)','rgba(255, 99, 132, 0.2)','rgba(153, 102, 255, 0.2)', 'rgba(255, 159, 64, 0.2)' ],
              borderColor: ['rgba(255, 99, 132, 1)', 'rgba(54, 162, 235, 1)', 'rgba(255, 206, 86, 1)', 'rgba(75, 192, 192, 1)', 'rgba(153, 102, 255, 1)', 'rgba(255, 159, 64, 1)', 'rgba(255, 159, 64, 1)', 'rgba(255, 159, 64, 1)'],
              borderWidth: 1
            },
          ]
          },
          options: {
            scales: {
              yAxes: [{
                ticks: {
                  beginAtZero: true
                }
              }]
            }
          }
        });
      }
  });

  var myChart = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: ['Jan', 'Feb', 'March', 'April', 'May', 'June', 'July', 'August', 'Sep', 'Oct', 'Nov', 'Dec'],
            datasets: [{
              label: 'Bitcoin Price',
              data: shuffleArray(y_array),
              backgroundColor: ['rgba(255, 99, 132, 0.2)', 'rgba(54, 162, 235, 0.2)', 'rgba(255, 206, 86, 0.2)', 'rgba(75, 192, 192, 0.2)', 'rgba(153, 102, 255, 0.2)', 'rgba(255, 159, 64, 0.2)', 'rgba(255, 159, 64, 0.2)','rgba(255, 99, 132, 0.2)','rgba(153, 102, 255, 0.2)', 'rgba(255, 159, 64, 0.2)' ],
              borderColor: ['rgba(255, 99, 132, 1)', 'rgba(54, 162, 235, 1)', 'rgba(255, 206, 86, 1)', 'rgba(75, 192, 192, 1)', 'rgba(153, 102, 255, 1)', 'rgba(255, 159, 64, 1)', 'rgba(255, 159, 64, 1)', 'rgba(255, 159, 64, 1)'],
              borderWidth: 1
            },
          ]
          },
          options: {
            scales: {
              yAxes: [{
                ticks: {
                  beginAtZero: true
                }
              }]
            }
          }
        });

      function shuffleArray(array) {
        var currentIndex = array.length,  randomIndex;
      
        // While there remain elements to shuffle...
        while (0 !== currentIndex) {
      
          // Pick a remaining element...
          randomIndex = Math.floor(Math.random() * currentIndex);
          currentIndex--;
      
          // And swap it with the current element.
          [array[currentIndex], array[randomIndex]] = [
            array[randomIndex], array[currentIndex]];
        }
      
        return array;
      }
        
      var resetCanvas = function () {
        document.querySelector('#myChart').remove(); // this is my <canvas> element
        appendHtml(document.querySelector('#graph-container'),'<canvas id="myChart"><canvas>');
        canvas = document.querySelector('#myChart'); // why use jQuery?
        ctx = canvas.getContext('2d');
        debugger
        ctx.canvas.width = document.querySelector('#graph-container').offsetWidth; // resize to parent width
        ctx.canvas.height = document.querySelector('#graph-container').offsetHeight + 150; // resize to parent height


        var x = canvas.width/2;
        var y = canvas.height/2;
        ctx.font = '10pt Verdana';
        ctx.textAlign = 'center';
        ctx.fillText('This text is centered on the canvas', x, y);
      };

      function appendHtml(el, str) {
        var div = document.createElement('div');
        div.innerHTML = str;
        while (div.children.length > 0) {
          el.appendChild(div.children[0]);
        }
      }
      setInterval(location.reload.bind(location), 60000);

</script>